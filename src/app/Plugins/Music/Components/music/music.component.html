<h1 class="mat-h1">Music</h1>

<mat-accordion>
  <mat-expansion-panel *ngIf=setup>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Setup
      </mat-panel-title>
      <mat-panel-description>
        Set up your spotify connection.
      </mat-panel-description>
    </mat-expansion-panel-header>

    <p>leave blank if config file exists</p>
    <div *ngIf=!setupStage2>
      <mat-form-field>
        <input matInput #clientID placeholder="ClientID">
      </mat-form-field>

      <mat-form-field>
        <input matInput #clientSecret placeholder="ClientSecret">
      </mat-form-field>

      <button mat-button color="primary" (click)="setInit(clientID.value, clientSecret.value)">Send</button>
    </div>
    <div *ngIf=setupStage2>
      <mat-card>authentication link: {{spotifyLink}}</mat-card>

      <mat-form-field>
        <input matInput #accessToken placeholder="Register token">
      </mat-form-field>

      <button mat-button color="primary" (click)="setToken(accessToken.value)">Send</button>
    </div>
  </mat-expansion-panel>

  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Search and Play something
      </mat-panel-title>
      <mat-panel-description>
        Search item an play
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-form-field>
      <input matInput #input placeholder="Search item">
    </mat-form-field>
    <mat-form-field>
      <mat-select [(value)]="activeType" placeholder="Choose type">
        <mat-option value="track">Track</mat-option>
        <mat-option value="artist">Artist</mat-option>
        <mat-option value="album">Album</mat-option>
        <mat-option value="playlist">Playlist</mat-option>
      </mat-select>
    </mat-form-field>
    <mat-tab-group>
      <mat-tab label="Search results">
        <div *ngFor="let playlist of searchResults; let i = index">
          <mat-list-item role="listitem">
            <mat-label>{{searchResults[i].name + " (from " + searchResults[i].artistName + ")"}}</mat-label>
            <button mat-icon-button color="primary" (click)="playSearchResults(i)">
              <mat-icon>play_circle_outline</mat-icon>
            </button>
          </mat-list-item>
        </div>
        <button mat-raised-button color="primary" (click)="search(input.value, activeType)">Search</button>
      </mat-tab>

    </mat-tab-group>
  </mat-expansion-panel>

  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Play Playlist
      </mat-panel-title>
      <mat-panel-description>
        Select a playlist
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-tab-group>
      <mat-tab label="Featured Playlists">
        <div *ngFor="let playlist of playlistAllFeatured; let i = index">
          <mat-list-item role="listitem">
            <mat-label>{{playlistAllFeatured[i].name}}</mat-label>
            <button mat-icon-button color="primary" (click)="playPlaylistFeatured(i)">
              <mat-icon>play_circle_outline</mat-icon>
            </button>
          </mat-list-item>
        </div>
        <button mat-raised-button color="primary" (click)="getPlaylistFeatured()">Refresh</button>
      </mat-tab>

      <mat-tab label="Own Playlists">
        <div *ngFor="let playlist of playlistAllUser; let i = index">
          <mat-list-item role="listitem">
            <mat-label>{{playlistAllUser[i].name}}</mat-label>
            <button mat-icon-button color="primary" (click)="playPlaylistUser(i)">
              <mat-icon>play_circle_outline</mat-icon>
            </button>
          </mat-list-item>
        </div>
        <button mat-raised-button color="primary" (click)="getPlaylistUser()">Refresh</button>
      </mat-tab>
    </mat-tab-group>
  </mat-expansion-panel>

  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Devices
      </mat-panel-title>
      <mat-panel-description>
        Select a device
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-tab-group>
      <mat-tab label="device selection">
        <mat-form-field>
          <mat-select [(value)]="activeDeviceID" placeholder="Choose device">
            <mat-option *ngFor="let device of deviceAll; let i = index" value={{deviceAll[i].id}}>
              {{device.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <button mat-icon-button color="primary" (click)="setDevice(activeDeviceID)">
          <mat-icon>play_circle_outline</mat-icon>
        </button>
        <p>You selected: {{activeDeviceID}}</p>
      </mat-tab>
      <mat-tab label="Rename device">
        <mat-form-field>
          <mat-select [(value)]="renameDeviceID" placeholder="Choose device">
            <mat-option *ngFor="let device of deviceAll; let i = index" value={{deviceAll[i].id}}>
              {{device.name}}
            </mat-option>
          </mat-select>

        </mat-form-field>
        <mat-form-field>
          <input matInput #deviceName placeholder="New name">
        </mat-form-field>
        <button mat-raised-button color="basic" (click)="setDeviceName(renameDeviceID, deviceName.value)">Rename</button>
      </mat-tab>
    </mat-tab-group>

    <button mat-raised-button color="primary" (click)="getDevs()">Refresh</button>
  </mat-expansion-panel>
</mat-accordion>

<div>
  <button mat-raised-button color="primary" (click)="getCurrentSong()">Current song</button>

  <button mat-icon-button color="primary" (click)="setBack()">
    <mat-icon>fast_rewind</mat-icon>
  </button>
  <button mat-icon-button *ngIf=!playing color="primary" (click)="setResume()">
    <mat-icon>play_arrow</mat-icon>
  </button>
  <button mat-icon-button *ngIf=playing color="primary" (click)="setPause()">
    <mat-icon>pause</mat-icon>
  </button>
  <button mat-icon-button color="primary" (click)="setSkip()">
    <mat-icon>fast_forward</mat-icon>
  </button>
  <mat-slider [max]="volumeMax" [min]="volumeMin" [step]="volumeStep" [(ngModel)]="volumeValue" (change)="changeVolume(volumeValue)">
  </mat-slider>
</div>
<div>
  <mat-list role="list">
    <mat-list-item role="listitem">Artist: {{musicData.artist}}</mat-list-item>
    <mat-list-item role="listitem">Title: {{musicData.title}}</mat-list-item>
  </mat-list>
</div>
<div *ngIf=playlist>
  <mat-list-item role="listitem">Playlist: {{musicPlaylistData.name}}</mat-list-item>
  <mat-list>
    <mat-list-item *ngFor="let music of playlistSongs; let i = index">
      <p matLine>Track: {{i +1}}</p>
      <p matLine>Artist: {{music.artist}}</p>
      <p matLine>Title: {{music.title}}</p>
    </mat-list-item>
  </mat-list>
</div>